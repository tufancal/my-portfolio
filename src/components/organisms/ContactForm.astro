---
import {
  storyblokEditable,
  type SbBlokData,
  renderRichText,
  type StoryblokRichTextNode,
} from "@storyblok/astro";
import type { ContactForm } from "@/.storyblok/types/285719928053161/storyblok-components";
import ContactFormReact from "./ContactFormReact";

export interface Props {
  blok: ContactForm;
}

const { blok } = Astro.props;
const {
  id,
  title,
  description,
  submit_button_text = "Anfrage senden",
  background = "base-200",
  max_width = "2xl",
} = blok;

const renderedDescription = description
  ? renderRichText(description as StoryblokRichTextNode)
  : null;
---

<section
  id={id}
  class={`bg-${background} py-16 sm:py-24`}
  {...storyblokEditable(blok as SbBlokData)}
>
  <div class={`container mx-auto max-w-${max_width} px-4`}>
    {
      title && (
        <h2 class="mb-4 text-center text-3xl font-bold sm:text-4xl">{title}</h2>
      )
    }

    {
      renderedDescription && (
        <div
          class="text-base-content/80 prose prose-sm mx-auto mb-12 text-center"
          set:html={renderedDescription}
        />
      )
    }

    <ContactFormReact
      client:idle
      submitButtonText={submit_button_text}
      serviceId={import.meta.env.EMAILJS_SERVICE_ID}
      templateId={import.meta.env.EMAILJS_TEMPLATE_ID}
      publicKey={import.meta.env.EMAILJS_PUBLIC_KEY}
    />
  </div>
</section>
